# Burp Suite
## Using Burp to Hack Cookies and Manipulate Sessions
  
First, ensure that Burp is correctly [configured with your browser](https://portswigger.net/burp/documentation/desktop/external-browser-config).  
  
With intercept turned off in the [Proxy](https://portswigger.net/burp/documentation/desktop/tools/proxy) "Intercept" tab, visit the login page of the application you are testing in your browser.  
  
![OWASP_AuthCookies_1](https://portswigger.net/support/images/owasp_accesscontrols_1.png)  
  
Log in to the application you are testing.  
  
You can log in using the credentials user:user.  
  
![OWASP_DataExposure_3](https://portswigger.net/support/images/owasp_dataexposure_3.png)  
  
Return to Burp.  
  
In the [Proxy](https://portswigger.net/burp/documentation/desktop/tools/proxy) "Intercept" tab, ensure "Intercept is on".  
  
![OWASP_AuthCookies_2](https://portswigger.net/support/images/owasp_authcookies_2.png)  
  
Refresh the page in your browser.  
  
The request will be captured by Burp, it can be viewed in the [Proxy](https://portswigger.net/burp/documentation/desktop/tools/proxy) "Intercept" tab.  
  
Cookies can be viewed in the cookie header.  
  
![OWASP_AuthCookies_3](https://portswigger.net/support/images/owasp_authcookies_3.png)  
  
We now need to investigate and edit each individual cookie.  
  
Right click anywhere on the request and click "Send to [Repeater](https://portswigger.net/burp/help/repeater.html)".  
  
**Note:** You can also send requests to Repeater via the context menu in any location where HTTP requests are shown, such as the site map or Proxy history.  
  
![OWASP_AuthCookies_4](https://portswigger.net/support/images/owasp_authcookies_4.png)  
  
Go to the [Repeater](https://portswigger.net/burp/help/repeater.html) tab.  
  
The cookies in the request can be edited easily in the "Params" tab.  
  
![OWASP_AuthCookies_5](https://portswigger.net/support/images/owasp_authcookies_5.png)  
  
By removing cookies from the request we can ascertain the function of each cookie.  
  
In this example, if the "username", "uid" and "PHPSESSID" cookies are removed, the session is ended and the user is logged out of the application.  
  
We can use the [Repeater](https://portswigger.net/burp/help/repeater.html) to remove cookies and test the response from the server.  
  
Remove and add cookies using the "Add" and "Remove" buttons and use the "Go" button to forward requests to the server.  
  
![OWASP_AuthCookies_6](https://portswigger.net/support/images/owasp_authcookies_6.png)  
  
Cookies can be edited in the Request "Params" table.  
  
In this example we have altered the value of the "uid" cookie to 1.  
  
Alter the value then click the "Go" button.  
  
![OWASP_AuthCookies_7](https://portswigger.net/support/images/owasp_authcookies_7.png)  
  
The response from the server can be viewed in the "Response" panel in Repeater.  
  
## Using Burp to Brute Force a Login Page

Authentication lies at the heart of an application’s protection against unauthorized access. If an attacker is able to break an application's authentication function then they may be able to own the entire application.

The following tutorial demonstrates a technique to bypass authentication using a simulated login page from the “Mutillidae” training tool. The version of “Mutillidae” we are using is taken from OWASP’s Broken Web Application Project. [Find out how to download, install and use this project](https://www.owasp.org/index.php/OWASP_Broken_Web_Applications_Project).

![OWASP_AuthAndSessionManagement_1](https://portswigger.net/support/images/owasp_authandsessionmanagement_1.png)

First, ensure that Burp is correctly [configured with your browser](https://portswigger.net/burp/documentation/desktop/external-browser-config).

In the Burp [Proxy](https://portswigger.net/burp/documentation/desktop/tools/proxy) tab, ensure "Intercept is off" and visit the login page of the application you are testing in your browser.

![OWASP_DataExposure_3](https://portswigger.net/support/images/owasp_dataexposure_3.png)

Return to Burp.

In the [Proxy](https://portswigger.net/burp/documentation/desktop/tools/proxy) "Intercept" tab, ensure "Intercept is on".

![OWASP_AuthAndSessionManagement_2](https://portswigger.net/support/images/owasp_authandsessionmanagement_2.png)

In your browser enter some arbitrary details in to the login page and submit the request.

![OWASP_AuthAndSessionManagement_3](https://portswigger.net/support/images/owasp_authandsessionmanagement_3.png)

The captured request can be viewed in the [Proxy](https://portswigger.net/burp/documentation/desktop/tools/proxy) "Intercept" tab.

Right click on the request to bring up the context menu.

Then click "Send to [Intruder](https://portswigger.net/burp/documentation/desktop/tools/intruder)".

**Note:** You can also send requests to the Intruder via the context menu in any location where HTTP requests are shown, such as the site map or Proxy history.

![OWASP_AuthAndSessionManagement_4](https://portswigger.net/support/images/owasp_authandsessionmanagement_4.png)

Go to the [Intruder](https://portswigger.net/burp/documentation/desktop/tools/intruder) "[Positions](https://portswigger.net/burp/help/intruder_positions.html)" tab.

Add the "username" and "password" parameter values as payload positions by highlighting them and using the "Add" button.

Change the attack to "Cluster bomb" using the "Attack type" drop down menu.

![OWASP_AuthAndSessionManagement_5](https://portswigger.net/support/images/owasp_authandsessionmanagement_5.png)

Go to the "[Payloads](https://portswigger.net/burp/help/intruder_payloads.html)" tab.

In the "Payload sets" settings, ensure "Payload set" is "1" and "Payload type" is set to "Simple list".

In the "[Payload settings](https://portswigger.net/burp/help/intruder_payloads_types.html)" field enter some possible usernames. You can do this manually or use a custom or pre-set payload list.

![OWASP_AuthAndSessionManagement_6](https://portswigger.net/support/images/owasp_authandsessionmanagement_6.png)

Next, in the "Payload Sets" options, change "Payload" set to "2".

In the "Payload settings" field enter some possible passwords. You can do this manually or using a custom or pre-set list.

Click the "Start attack" button.

![OWASP_AuthAndSessionManagement_7](https://portswigger.net/support/images/owasp_authandsessionmanagement_7.png)

In the "[Intruder](https://portswigger.net/burp/documentation/desktop/tools/intruder) attack" window you can sort the results using the column headers.

In this example sort by "Length" and by "Status".

![OWASP_AuthAndSessionManagement_8](https://portswigger.net/support/images/owasp_authandsessionmanagement_8.png)

The table now provides us with some interesting results for further investigation.

By viewing the response in the attack window we can see that request 118 is logged in as "admin".

![OWASP_AuthAndSessionManagement_9](https://portswigger.net/support/images/owasp_authandsessionmanagement_9.png)

To confirm that the brute force attack has been successful, use the gathered information (username and password) on the web application's login page.

### Account Lock Out

![OWASP_AuthAndSessionManagement_10](https://portswigger.net/support/images/owasp_authandsessionmanagement_10.png)

In some instances, brute forcing a login page may result in an application locking out the user account. This could be the due to a lock out policy based on a certain number of bad login attempts etc.

Although designed to protect the account, such policies can often give rise to further vulnerabilities. A malicious user may be able to lock out multiple accounts, denying access to a system.

In addition, a locked out account may cause variances in the behavior of the application, this behavior should be explored and potentially exploited.

### Verbose Failure Messages

![OWASP_AuthAndSessionManagement_11](https://portswigger.net/support/images/owasp_authandsessionmanagement_11.png)

Where a login requires a username and password, as above, an application might respond to a failed login attempt by indicating whether the reason for the failure was an unrecognized username or incorrect password.

In this instance, you can use an automated attack to iterate through a large list of common usernames to enumerate which ones are valid.

A list of enumerated usernames can be used as the basis for various subsequent attacks, including password guessing, attacks on user data or sessions, or social engineering.

### Scanning a login page

![OWASP_AuthAndSessionManagement_12](https://portswigger.net/support/images/owasp_authandsessionmanagement_12.png)

In addition to manual testing techniques, Burp [Scanner](https://portswigger.net/burp/documentation/desktop/scanning) can be used to find a variety of authentication and session management vulnerabilities.

In this example, the [Scanner](https://portswigger.net/burp/documentation/desktop/scanning) was able to enumerate a variety of issues that could help an attacker break the authentication and session management of the web application.
  
The response shows that by altering the "uid" cookie we have logged in to the application as "admin".  
  
We have used cookies to manipulate the session and access another account with elevated privileges.  
